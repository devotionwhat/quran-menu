<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YouTube Channel Video Player (No API Key)</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        .parent-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 {
            margin-bottom: 20px;
        }
        #video-player {
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        #YouTube-Iframe {
            width: 100%;
            aspect-ratio: 16/9;
            border: none;
            display: block;
        }
        #video-caption {
            padding: 12px 16px;
            font-size: 1.2rem;
            background: #222;
            border-bottom: 1px solid #333;
        }
        #playlist {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            padding: 16px;
            background: #111;
            max-height: 400px;
            overflow-y: auto;
        }
        .playlist-button {
            background: #2a2a2a;
            border: none;
            border-radius: 6px;
            padding: 8px;
            color: #fff;
            cursor: pointer;
            text-align: left;
            font-size: 0.9rem;
            transition: background 0.2s;
            display: flex;
            flex-direction: column;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            min-height: 120px;
            border: 1px solid #444;
        }
        .playlist-button:hover {
            background-color: #3a3a3a;
            border-color: #888;
        }
        .playlist-button.active {
            border-color: #ff0000;
            box-shadow: 0 0 8px #ff0000;
        }
        .playlist-button .title {
            background: rgba(0,0,0,0.7);
            padding: 4px 6px;
            border-radius: 4px;
            margin-top: auto;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 4px black;
        }
        .loading {
            color: #aaa;
            padding: 20px;
            text-align: center;
            font-style: italic;
        }
        .error-message {
            color: #ff8080;
            padding: 10px;
            background: #330000;
            border-radius: 4px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div class="parent-container">
    <h1>YouTube Channel Video Player</h1>
    <div id="video-player">
        <iframe id="YouTube-Iframe" class="lazyload" src="https://www.youtube.com/embed/3YHVC1DcHmo?enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        <div id="video-caption">Jon Batiste ♩ FREEDOM</div>
        <div id="playlist">
            <!-- Playlist will be populated dynamically -->
            <div class="loading">Loading videos...</div>
        </div>
    </div>
</div>

<script>
    (function() {
        // ===== HARDCODED CHANNEL ID =====
        // Change this to any YouTube channel ID you want
        const CHANNEL_ID = 'UCXuqSBlHAE6Xw-yeJA0Tunw';  // Linus Tech Tips

        // DOM elements
        const playlistDiv = document.getElementById('playlist');
        const youtubeIframe = document.getElementById('YouTube-Iframe');
        const videoCaption = document.getElementById('video-caption');

        // Fetch and parse RSS feed for a channel ID
        async function loadChannelVideos(channelId) {
            if (!channelId) return;
            const feedUrl = `https://www.youtube.com/feeds/videos.xml?channel_id=${channelId}`;

            // Show loading state
            playlistDiv.innerHTML = '<div class="loading">Loading videos...</div>';

            try {
                const response = await fetch(feedUrl);
                if (!response.ok) throw new Error(`HTTP error ${response.status}`);
                const xmlText = await response.text();

                // Parse XML manually with regex (simple and works without namespaces)
                const videoEntries = [];
                const entryRegex = /<entry>([\s\S]*?)<\/entry>/gi;
                let entryMatch;
                while ((entryMatch = entryRegex.exec(xmlText)) !== null) {
                    const entryContent = entryMatch[1];

                    // Extract videoId from <yt:videoId>...</yt:videoId>
                    const videoIdMatch = entryContent.match(/<yt:videoId>([^<]+)<\/yt:videoId>/i);
                    if (!videoIdMatch) continue;
                    const videoId = videoIdMatch[1];

                    // Extract title from <title>...</title>
                    const titleMatch = entryContent.match(/<title>([^<]+)<\/title>/i);
                    const title = titleMatch ? titleMatch[1] : 'Untitled';

                    videoEntries.push({ videoId, title });
                }

                if (videoEntries.length === 0) {
                    playlistDiv.innerHTML = '<div class="error-message">No videos found or invalid channel ID.</div>';
                    return;
                }

                // Build the playlist buttons
                buildPlaylist(videoEntries);

            } catch (error) {
                console.error('Error loading feed:', error);
                playlistDiv.innerHTML = `<div class="error-message">Failed to load videos: ${error.message}. Make sure the channel ID is correct and the feed is accessible.</div>`;
            }
        }

        // Build playlist buttons from array of {videoId, title}
        function buildPlaylist(videos) {
            // Clear playlist
            playlistDiv.innerHTML = '';

            videos.forEach((video) => {
                const videoId = video.videoId;
                const title = video.title;
                const thumbnail = `//img.youtube.com/vi/${videoId}/sddefault.jpg`;
                const embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&enablejsapi=1`;

                // Create button
                const button = document.createElement('button');
                button.className = 'playlist-button';
                button.setAttribute('data-iframe', embedUrl);
                button.setAttribute('data-caption', title);
                button.style.backgroundImage = `url('${thumbnail}')`;
                button.style.backgroundSize = 'cover';
                button.style.backgroundPosition = 'center';

                // Add title span
                const titleSpan = document.createElement('span');
                titleSpan.className = 'title';
                titleSpan.textContent = title.length > 60 ? title.substring(0, 60) + '…' : title;
                button.appendChild(titleSpan);

                playlistDiv.appendChild(button);
            });

            // Optionally auto-click the first video after a short delay (so the user sees something)
            // You can enable this if you want the first video to load immediately.
            // setTimeout(() => {
            //     const firstButton = playlistDiv.querySelector('.playlist-button');
            //     if (firstButton) firstButton.click();
            // }, 500);
        }

        // Event listener for playlist clicks (using event delegation)
        playlistDiv.addEventListener('click', function(e) {
            const button = e.target.closest('.playlist-button');
            if (!button) return;

            // Remove active class from all buttons
            document.querySelectorAll('.playlist-button').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');

            // Update iframe src
            const iframeSrc = button.getAttribute('data-iframe');
            if (iframeSrc) {
                youtubeIframe.src = iframeSrc;
            }

            // Update caption
            const caption = button.getAttribute('data-caption');
            if (caption) {
                videoCaption.textContent = caption;
            }
        });

        // Load videos on page load
        window.addEventListener('load', function() {
            loadChannelVideos(CHANNEL_ID);
        });
    })();
</script>
</body>
</html>
